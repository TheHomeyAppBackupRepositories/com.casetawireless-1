"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var BACKTICK = 96;
var EQUALS = 61;
function decodeTXT(buffer, offset, length) {
    if (offset === void 0) { offset = 0; }
    if (length === void 0) { length = buffer.length; }
    // Attempt to detect RFC-1464 records
    var o = offset;
    var quoted = false;
    var readingValue = false;
    var key = [];
    var value = [];
    while (o < length) {
        var v = buffer[o];
        if (quoted) {
            if (v === BACKTICK) {
                key.push('`');
            }
            else if (v === EQUALS) {
                key.push('=');
            }
            else {
                // Assume malformed key and push both backtick and value
                key.push('`');
                key.push(String.fromCharCode(v));
            }
            quoted = false;
        }
        else {
            if (readingValue) {
                value.push(String.fromCharCode(v));
            }
            else {
                if (v === BACKTICK) {
                    quoted = true;
                }
                else if (v === EQUALS) {
                    readingValue = true;
                }
                else {
                    key.push(String.fromCharCode(v));
                }
            }
        }
        o++;
    }
    if (key.length === 0)
        return null;
    var keyString = key.join('').toLowerCase();
    if (value.length === 0) {
        return {
            key: keyString,
            value: true
        };
    }
    else {
        return {
            key: keyString,
            value: value.join('')
        };
    }
}
exports.decodeTXT = decodeTXT;
//# sourceMappingURL=txt.js.map